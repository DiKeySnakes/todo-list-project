(()=>{"use strict";!function(){const e=document.querySelector("[data-projects-list]"),t=document.querySelector("[data-new-project-form]"),n=document.getElementById("tasksContainer"),a=document.querySelector("[data-project-title]"),o=document.querySelector("[data-task-count]"),s=document.querySelector("[data-tasks-cards]"),l=document.querySelector("[data-clear-complete-tasks-button]"),r=document.querySelector("[data-delete-project-button]"),c=document.querySelector("[data-new-task-form]"),i=document.getElementById("newTaskPriorityInput"),d=document.getElementById("newTaskNameInput"),m=document.getElementById("newProjectNameInput"),u=document.getElementById("newTaskDueDateInput"),p=document.getElementById("newTaskDescriptionInput"),g=document.getElementById("newTaskMessage"),k=document.getElementById("newProjectMessage"),y=document.getElementById("addTask"),f=document.getElementById("addProject"),E=document.getElementById("tasks-template"),v="task.projects",L="task.selectedProjectId";let I=JSON.parse(localStorage.getItem(v))||[],S=localStorage.getItem(L);e.addEventListener("click",(e=>{"li"===e.target.tagName.toLowerCase()&&(S=e.target.dataset.projectId,w(),B())})),n.addEventListener("click",(e=>{if("input"===e.target.tagName.toLowerCase()){const t=I.find((e=>e.id===S));t.tasks.find((t=>t.id===e.target.id)).complete=e.target.checked,w(),M(t),B()}})),l.addEventListener("click",(e=>{const t=I.find((e=>e.id===S));t.tasks=t.tasks.filter((e=>!e.complete)),w(),B()})),r.addEventListener("click",(e=>{I=I.filter((e=>e.id!==S)),S=null,w(),B()})),c.addEventListener("submit",(e=>{e.preventDefault(),T()})),t.addEventListener("submit",(e=>{e.preventDefault(),h()}));const T=()=>{""===d.value?(console.log("failure"),g.innerHTML="Task cannot be blank"):(console.log("success"),g.innerHTML="",q(),y.setAttribute("data-bs-dismiss","modal"),y.click(),y.setAttribute("data-bs-dismiss",""))},h=()=>{const e=m.value;null==e||""===e?(console.log("failure"),k.innerHTML="Project cannot be blank"):(console.log("success"),k.innerHTML="",b(),f.setAttribute("data-bs-dismiss","modal"),f.click(),f.setAttribute("data-bs-dismiss",""))},b=()=>{const e=m.value,t=(n=e,{id:Date.now().toString(),name:n,tasks:[]});var n;I.push(t),w(),console.log(I),B()},q=()=>{const e=i.value,t=d.value,n=u.value,a=p.value,o=(s=e,l=t,r=n,c=a,{id:Date.now().toString(),priority:s,name:l,date:r,description:c,complete:!1});var s,l,r,c;const m=I.find((e=>e.id===S));console.log(m),m.tasks.push(o),w(),console.log(o),B()},j=()=>{const e=I.find((e=>e.id===S));s.innerHTML="",e.tasks.forEach((e=>{const t=document.importNode(E.content,!0),n=t.querySelector("[data-tasks-div]");n.id=e.id,console.log(e.id);const a=t.querySelector("input");a.id=e.id,a.checked=e.complete;t.querySelector("label").htmlFor=e.id;document.querySelector("data-priority");n.dataset.priority=e.priority,console.log(e.priority);let o=t.querySelector("[data-task-name]");o.innerHTML=e.name,console.log(e.name);let l=t.querySelector("[data-task-date]");l.innerHTML=e.date,console.log(e.date);let r=t.querySelector("[data-task-description]");r.innerHTML=e.description,console.log(e.description),console.log(e.complete),e.complete&&(n.classList.add("complete"),o.dataset.taskName="complete",l.dataset.taskDate="complete",r.dataset.taskDescription="complete"),s.appendChild(t)})),c.reset()};function w(){localStorage.setItem(v,JSON.stringify(I)),localStorage.setItem(L,S)}function M(e){const t=e.tasks.filter((e=>!e.complete)).length,n=1===t?"task":"tasks";o.innerText=`${t} ${n} remaining`}function B(){!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(e),I.forEach((t=>{const n=document.createElement("li");n.dataset.projectId=t.id,n.classList.add("project-name"),n.innerText=t.name,t.id===S&&n.classList.add("active-project"),e.appendChild(n)})),t.reset();const o=I.find((e=>e.id===S));null==S?n.style.display="none":(n.style.display="",a.innerText=o.name,M(o),j())}s.addEventListener("click",(e=>{if(e.target.classList.contains("fa-trash-alt"))(e=>{const t=I.find((e=>e.id===S));e.target.parentElement.parentElement.remove(),t.tasks=t.tasks.filter((t=>t.id!==e.target.parentElement.parentElement.id)),w(),B(),console.log(t.tasks)})(e),j();else{if(!e.target.classList.contains("fa-edit"))return;(e=>{let t=e.target.parentElement.parentElement;d.value=t.firstElementChild.children[1].textContent.trim(),u.value=t.children[1].innerHTML,p.value=t.children[2].innerHTML;const n=I.find((e=>e.id===S));e.target.parentElement.parentElement.remove(),n.tasks=n.tasks.filter((t=>t.id!==e.target.parentElement.parentElement.id)),w(),console.log(n.tasks)})(e)}})),B()}()})();